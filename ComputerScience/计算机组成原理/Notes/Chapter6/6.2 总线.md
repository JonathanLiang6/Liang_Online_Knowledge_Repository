计算机系统中不同部件之间需要通过**信号线**相互连接起来，在彼此之间传送各种信息。 部件之间需要传递的信息主要是 3 种：**地址信息**、**数据信息**和**控制信息**。
### 6.2.1 总线
各部件之间传送信息的公共通路称为**总线**。
实质上总线是一个共享的传输媒介。当多个设备连接到总线上，其中任何一个通过总线传输的信号都能被连接到总线上的其它设备所接收。
如果两个设备同时向总线发送信号，总线上的信号就会叠加而发生混乱，因此要对各功能部件使用总线的方式进行一定的限制，保证任何时候只有一个设备向总线发送信号。
#### 6.2.1.1 总线的分类
1. 按总线所承担的任务可分为**内部总线**和**外部总线**。
**内部总线**用于实现主机系统内部各功能模块（部件、板卡）之间的互联
**外部总线**用于实现主机系统与外部设备或其他主机系统之间的互联。
其中，专门用于主机系统与外设之间互连的总线称为**设备总线**。
2. 按总线所处的物理位置可分为**片内总线**、**板内总线**、**板间总线**和**外部总线**。
**片内总线**实现芯片内部功能部件之间的连接，例如微处理器内部使用的总线，
**板内总线**实现该电路板上各个集成电路芯片之间的互联，
**板间总线**则用于把各个功能模块（如 CPU 主存储器、I/O 接口适配器等）连接到一起，构成主机系统，所以也称它为**系统总线**。
3. 总线分类按总线所传送的信息类型可分为**地址总线**、**数据总线**和**控制总线**等。
4. 按总线一次传送数据的位数又分为串行总线和并行总线。
5. 按总线操作的定时方式，又有同步总线和异步总线之分
#### 6.2.1.2 总线标准
主要从以下几个方面来描述总线的功能和特性
（1）**逻辑规范**：引脚信号的功能描述，包括信号的含义、信号的传送方向（发送接收或双向）、有效信号所采用的电平极性 （高电平/低电平，正脉冲/负脉冲）及是否具有三态能力等。
（2）**时序规范**：描述各信号有效/无效的发生时间以及不同信号之间相互配合的时间关系。例如当地址信号有效后，至少需要多长时间的延迟才能使读/写信号有效。总线标准
（3）**电器规范**：总线上各个信号所采用的电平标准和负载能力。负载能力定义了总线理论上最多可以连接模块的数量。
（4）**机械规范**：它定义了总线包括插槽/插头或插板的结构、形状、大小方面的物理尺寸、接插件机械强度；总线信号的布局、引脚信号的长度、宽度以及间距等。
（5）**通信协议**：定义数据通过总线传输时采用的连接方法数据格式、发送速度等方面的规定。对串行总线而言会有这方面的规范。通信协议通常还要分为若干层次。
#### 6.2.1.3 总线性能
总线的性能水平主要由以下几个因素决定：
（1）**总线带宽**：总线带宽表示在单位时间内，总线所能传输的最大数据量，一般用兆字节/秒（MB/S）来表示。
（2）**总线宽度**：笼统地说，一个总线所设置的通信线路（或线缆）的数目称为该总线的**宽度**。具体来说，在一个总线内设置的用于**传送数据/地址的信号线**的数目，称为**数据/地址总线宽度**。
	**数据总线的宽度**决定了一次可以同时传送的二进制信息的位数。
	在总线工作频率一定的条件下，数据总线单位时间内的数据传输量与数据总线的宽度成正比关系，因此数据总线的宽度是决定计算机系统性能的一个关键特性。
	**地址总线的宽度**决定计算机系统的寻址能力。
（3）**总线的时钟频率**：对于同步总线来说，由于采用统一的时钟脉冲作为定时基准，因此总线的时钟频率越高，总线上的操作就越快。显然，在数据总线宽度相同的情况下，较高的总线时钟频率会带来较大的数据吞吐量。
（4）**总线的负载能力**：限定在总线上可以连接模块的最大数目。一般来说，都希望总线具有较高的带宽和较强的负载能力。
### 6.2.2 总线的控制与裁决
#### 6.2.2.1 总线控制（仲裁）器：管理总线使用权
由于总线属于共享资源，为确保各个功能模块正确使用总线，需要有一个专门的部件来负责对总线的使用权进行管理和分配，这个专门部件就是**总线控制器**，也叫总线仲裁器
**主设备**：经过裁决后，获得总线使用权的设备成为主设备
**从设备**：与主设备交换数据的设备为从设备。
由此一来，通过总线相互连接的各个功能模块在需要利用总线传输数据时，需经历**四个阶段**：申请、仲裁、传输、结束
#### 6.2.2.2 总线事务：申请、仲裁、传输、结束
**申请阶段**：某个模块需要利用总线和别的模块传输数据时，先向总线控制器提出请求。
**仲裁阶段**：总线控制器接收到各个模块的请求后，根据一定的优先级规则进行裁决，确定谁将获得总线的使用权并且对获得使用权的模块作出回应。
**传输阶段**：获得使用权的模块接管总线并利用总线传输自己的数据。
**结束阶段**：获得总线使用权的模块利用总线传输完数据后，释放总线。
#### 6.2.2.3 总线仲裁方式：集中式并行/串行仲裁
总线仲裁的方式可以采用**集中式**，也可以采用**分布式**。
**集中式**仲裁由单一总线仲裁器负责管理各个模块的总线请求并作出裁决，又可以细分为**并行裁决**和**串行裁决**![[../../Picture/Pasted image 20241203143742.png]]![[../../Picture/Pasted image 20241203143808.png]]
### 6.2.3 计算机系统的总线结构
计算机系统中的总线的组织方法很多，按照总线的组织结构不同可以分成：单/双/多总线结构的计算机系统
#### 6.2.3.1 单总线结构
![[../../Picture/Pasted image 20241203150210.png]]
采用称为系统总线的一组总线来连接整个计算机系统中的各个功能部件，例如处理机模块、主存储器模块、I/O 设备控制器模块等，
计算机系统中的所有外部设备通过设备控制器也挂在这条总线上。在这种结构的计算机系统内部，各个功能部件之间的**所有信息传送都通过系统总线**来实现
#### 6.2.3.2 双总线结构
![[../../Picture/Pasted image 20241203150236.png]]
增加了一条内存总线，CPU 访问主存单元时通过内存总线来实现，原有的系统总线则用来实现 CPU 与外设以及内存与外设之间的数据通信
#### 6.2.3.3 多总线结构 
![[../../Picture/Pasted image 20241203150243.png]]
多总线结构的计算机系统是在双总线结构基础上**增加 I/O 总线**实现的一种计算机系统结构，目的是进一步提高计算机系统的工作效率。
这种总线结构是在计算机系统的各部件之间采用**多条各自独立的总线来构成分层次**的信息通路
#### 6.2.3.4 多层次总线结构
![[../../Picture/Pasted image 20241203150314.png]]
根据系统功能模块性能上的要求，设置不同层次、不同种类的总线，不会完全拘泥于上述三种总线结构
### 6.2.4 总线定时
功能模块获得总线使用权后利用总线传输数据是由一序列的操作构成的，这些操作在时间上是有先后的。`e.g 处理机要从内存中读数据时，需要先通过地址线向内存发送存储单元的地址，然后通过控制线向内存发出读控制，最后将内存发送到数据线上的数据读入。 `
**总线定时**指的就是协调总线上发生的事件的时间顺序和时间长度，换言之，就是协调各种信号在总线上出现和撤销的时机 
总线定时的方法分为**同步定时**和**异步定时**，由此总线又可分为同步总线和异步总线。
#### 6.2.4.1 同步定时：同步总线
总线上所有事件的发生都由同一个时钟脉冲序列来定时。在这种定时方式下，总线应包含一条时钟信号线，该时钟信号线负责传送一个固定频率的方波信号。一个时钟周期就是一个最基本的总线操作的时间单位，一个总线周期则由一个或多个时钟周期构成。 
**总线周期**：利用总线完成一次数据交换所花费的时间 
连接到总线上的所有设备都通过时钟信号线获取用于**事件同步**的时钟脉冲信号，所有的总线事件都应在一个时钟周期的开始时启动动作
#### 6.2.4.2 异步定时：异步总线
在采用异步定时的总线中，总线上一个事件发生与否，依赖于前一个事件的执行情况。
### 6.2.5 常用总线
- PCI局部总线
要求计算机系统具有对图形/图像数据的高速处理以及对显示数据的快速传输能力
- PCI Express总线
PCI Express 总线并不是 PCI 技术的延续，即 PCI Express 总线不是原有 PCI 总线的升级，而是一个全新的第三代总线。
- 设备总线：
（1）**小型计算机系统接口**（Small Computer System Interface，SCSI） 是用于小型、微型计算机和外围设备连接的一种接口标准，它可以支持包括磁盘驱动器、磁带机、光盘驱动器以及扫描仪在内的多种外部设备。
虽然称它为接口，但 SCSI 接口**实际上是一种外部并行总线** 
（2）ATA **接口**（AT 附件）：是微型计算机主板与硬盘等外部存储器之间的一种接口或总线。ATA 接口的前身是 IDE 接口，即集成设备电子部件。 
（3）USB **接口**： USB 是通用串行总线的简称，是由英特尔、康柏、微软、NEC、北方电信等多家世界著名的计算机和通信公司联合开发的一种新型**串行接口总线**标准。

### [[../../Contents/第六章 输入输出系统|回到目录]]