### 5.2.1 UDP 数据报

#### 5.2.1.1 UDP 特点对比
- UDP 首部很小，固定 8B  
- UDP 每次传输一个完整报文，不支持报文自动拆分、重装  
- UDP 是无连接的、不可靠的（可靠性可交给应用层处理），也不支持拥塞控制  
- UDP 支持一对一（封装成单播 IP 数据报）、一对多传输（封装成广播/多播 IP 数据报）  
#### 5.2.1.2 UDPvsTCP

| 特性   | UDP                      | TCP                        |
| ---- | ------------------------ | -------------------------- |
| 首部大小 | 8B                       | 20~60B                     |
| 报文处理 | 一次一个完整报文，不拆分重装（**面向报文**） | 支持自动拆分、重装，可传长报文（**面向字节流**） |
| 连接性  | 无连接                      | 有连接                        |
| 可靠性  | 不可靠                      | 可靠                         |
| 拥塞控制 | 不支持                      | 支持                         |
| 传输方式 | 一对一、一对多                  | 仅一对一                       |
#### 5.2.1.2 UDP 数据报格式

| 字段      | 位数  | 说明                     |
| ------- | --- | ---------------------- |
| 源端口号    | 16  | 发送进程端口号（不需回传可置 0）      |
| 目的端口号   | 16  | 接收进程端口号（必填）            |
| UDP 长度  | 16  | 包含首部的整个数据报长度（字节为单位）    |
| UDP 检验和 | 16  | 发送方计算填入，接收方校验；无需校验可置 0 |
- 首部长度固定 8B  
- 数据部分：完整的应用层报文  
- 理论最大长度：65535B（含首部）实际最大长度为 65515
### 5.2.2 UDP 检验
![[../../CN_Picture/Pasted image 20251203112830.png]]
#### 5.2.2.1 检验和计算（发送方）
1. 添加伪首部（12 B，含源/目的 IP、协议字段、UDP 长度）。  
2. 按 16 bit 一组进行二进制加法，最高位进位回卷。  
3. 最终结果逐位取反，得到 16 bit 检验和并填入 UDP 首部。  
4. 拆除伪首部后发送。
#### 5.2.2.2 差错检验（接收方）
1. 重新添加伪首部。  
2. 按 16 bit 一组进行二进制加法，最高位进位回卷。  
3. 结果判断：  
   - 若加法结果为全 1，说明无差错，接收该 UDP 数据报；  
   - 若加法结果不是全 1，说明有差错，丢弃该 UDP 数据报。  
4. 拆除伪首部。
**注**：伪首部仅用于检验和计算，不加入网络传输。
### [[../../CN_Contents/第五章 传输层|回到目录]]