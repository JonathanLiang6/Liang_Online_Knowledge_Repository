### 3.5.1 局域网基本概念与体系结构
#### 3.5.1.1 局域网的特点
1. 覆盖较小的地理范围 
2. 较低的时延和误码率 
3. 局域网内的各节点之间以“帧”为单位进行传输 
4. 支持单播、广播、多播![[../../CN_Picture/Pasted image 20251205104819.png]]
#### 3.5.1.2 局域网（LAN）的分类
**关注要点**：①拓扑结构②传输介质③介质访问控制
##### 3.5.1.2.1 有线局域网
**令牌环网**
①环形拓扑②同轴电缆/双绞线③令牌传递协议
**以太网/802.3（从上到下按照时间顺序**）
- **同轴电缆以太网**（早期）
	- ①总线型拓扑②同轴电缆，可用中继器连接多个同轴电缆网段③CSMA/CD协议
- **双绞线以太网**
	- 用**集线器**连接
		- ①物理上星形，逻辑上总线形②双绞线(用**集线器**连接)③CSMA/CD 协议
	- 用**交换机**连接
		- ①物理上逻辑上均为星形②双绞线(用**交换机**连接)③CSMA/CD 协议或 NULL
		- 半双工模式：CSMA/CD
		- 全双工模式：不需要争抢信道
- **光纤以太网**
	- ①点对点（用于中继器/集线器/交换器等中间节点的连接，通常不会直接连接终端节点）②光纤③NULL（不需要考虑）：用两条光纤实现**全双工通信**
##### 3.5.1.2.2 无线局域网 WLAN
WiFi/802.11
①IEEE 802.11 定义为星形 (1 个 AP+N 台移动设备)
②无线 (Wireless)
③CSMA/CA 协议
#### 3.5.1.3 局域网的硬件架构
![[../../CN_Picture/Pasted image 20251205112819.png]]
要点:
1. 负责把帧发送到局域网。
	- **注**: 关于“将 IP 数据报 (IP 分组) 封装成帧”，有些系统由主机实现，有些系统由网络适配器负责。
2. 负责从局域网接收帧。
	- 如果收到**正确帧**，就用“中断”通知 CPU; 如果收到**异常帧**，就直接丢弃 
3. 需要根据接入的局域网类型，按照标准实现**数据链路层+物理层**功能 
4. 需要完成数据的串/并行转换
5. 需要支持帧缓冲
### 3.5.2 以太网与 IEEE 802.3
IEEE 将**数据链路层**划分为：
逻辑链路控制子层(LLC)(名存实亡)+介质访问控制子层(MAC)+物理层
后两者是以太网技术的研究范畴
#### 3.5.2.1 物理层标准命名规则
- 格式：速率 + Base + 传输介质信息  
  - 同轴电缆：10Base5、10Base2  
  - 双绞线：10BaseT、100BaseTX、2.5GBaseT  
  - 光纤：10BaseF、100BaseFX、40GBaseFR（很少考）
#### 3.5.2.2 工作模式与 CSMA/CD 关系
- 网段仅在**半双工**模式下才需使用 CSMA/CD 协议实现介质访问控制。  
  - 同轴电缆网段：仅支持半双工。  
  - 双绞线网段：  
    - 连接集线器 → 强制半双工，必须运行 CSMA/CD
    - 连接交换机 → 默认全双工，无需 CSMA/CD
    - **速率**≥2.5Gbps 仅支持全双工；＜2.5Gbps 在节点连接时协商
  - 光纤网段：仅支持全双工
#### 3.5.2.3 MAC 帧格式
| 标准        | 字段组成（顺序）    | 备注               |
| --------- | ----------- | ---------------- |
| V2 标准（默认） | 662N4，收发协数验 | N = 46–1500 B 数据 |
| 802.3 标准  | 662N4，收发长数验 | N = 46–1500 B 数据 |
![[../../CN_Picture/Pasted image 20251206092732.png]]
- 物理层会在 MAC 帧前添加 8 B 前导码（7 B 同步 + 1 B 定界）。
#### 3.5.2.4 单播帧与广播帧的传播
![[../../CN_Picture/Pasted image 20251206094502.png]]
- 一个 MAC 地址 6 B（48 bit）；目的地址全 1 表示广播帧。  
- 交换机会将收到的广播帧转发至其他端口；路由器不会转发广播帧。
- **注**: MAC 地址是数据链路层的概念。路由器、交换机都有 MAC 地址（甚至多个），而集线器没有 MAC 地址
### 3.5.3 虚拟局域网 VLAN
**背景**：大型局域网面临的问题：整个局域网是一个很大的广播域，容易出现广播风暴；不利于信息安全。
#### 3.5.3.1 VLAN 的特点
- 可将一个大型局域网分割成若干个较小的 VLAN，每个 VLAN 是一个广播域。  
- 需要使用**支持 VLAN 功能的以太网交换机**来实现。  
- 每个 VLAN 对应一个 VID。
#### 3.5.3.2 划分 VLAN 的方式
| 方式 | 依据 | VID 对应关系 |
| --- | --- | --- |
| 基于接口 | 交换机物理接口 | VID ↔ 接口号 |
| 基于 MAC 地址 | 主机 MAC 地址 | VID ↔ MAC 地址 |
| 基于 IP 地址 | 主机 IP 地址 | VID ↔ IP 地址；可让 VLAN 跨越路由器，把多个局域网的主机组成一个 VLAN（需网络层功能支持） |
 #### 3.5.3.4 帧格式差异
- 主机与交换机之间：传输标准以太网帧（662N4，收发协数验）。  
- 交换机与交换机之间（干线链路）：传输 802.1Q 帧（6642N4，收发 V 协数验）。
#### 3.5.3.5 802.1Q 帧构成
![[../../CN_Picture/Pasted image 20251206174520.png]]

- 4 字节 VLAN 标签 = 16 bit（固定） + 4 bit（无意义） + 12 bit（发送方所属 VLAN 的VID）
### 3.5.4 IEEE 802.11 无线局域网
**无线局域网**分为有**固定基础设施无线局域网**（`e.g 802.11`）和**无固定基础设施移动自组织网络**（`e.g airdrop，huawei share`）
#### 3.5.4.1 拓扑与基本术语
- **拓扑**：星形，中心为接入点（AP，也可称无线接入点 WAP）。  
- **SSID**：服务集标识符，≤ 32 字节。  
- **BSS（基本服务集）**：1 个 AP + N 个移动站，覆盖范围称为 BSA（基本服务区）
- **ESS（扩展服务集）**：把多个 AP 接入同一分配系统，组成更大服务集，支持漫游——移动站可丝滑切换 AP 且通信不中断。  
- **Portal（门户）**：将 802.11 无线局域网接入 802.3 有线以太网。
#### 3.5.4.2 帧分类与格式
- **帧分类**：  
  ① 数据帧；
  ② 控制帧（如 ACK、RTS、CTS）；
  ③ 管理帧（如探测请求/探测响应）。  
- **数据帧格式**：
- ![[../../CN_Picture/Pasted image 20251206210721.png]]
#### 3.5.4.3 其他内容
- 使用 **CSMA/CA 协议** 实现介质访问控制。
- 帧的中转靠 AP；两个移动站之间不能直接通信，必须通过 AP 转发。  
- AP 通常具备“帧格式转换”功能：802.11 ↔ 以太网。  
- **链路类型**：  
  - AP ↔ 移动站：无线链路；  
  - AP ↔ AP、AP ↔ 路由器、AP ↔ 以太网交换机：通常有线链路。
### [[../../CN_Contents/第三章 数据链路层|回到目录]]