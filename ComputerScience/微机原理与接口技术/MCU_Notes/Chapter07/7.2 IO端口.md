**端口**：每个接口电路内部所含的寄存器称为 I/O 端口（PORT）。 
每个端口对应一个 I/O 端口地址； 
**数据端口**：数据缓冲寄存器，用来存储 CPU 与外部设备之间传送的数据信息； 
**状态端口**：状态寄存器，用来存放外部设备或接口部件的状态 （准备就绪位 Ready，忙碌位 Busy，错误位 Error）； 
**控制接口**：控制寄存器，用于存放 CPU 发出的命令，控制接口和外部设备的动作。
### 7.2.1 I/O 端口的编址方式
1. **统一编址**：将 I/O 端口地址与存储单元一起编址
I/O 端口占用部分内存地址空间，可看作是存储器的一部分。
I/O 端口和存储单元有不同的地址编号，存储器使用的指令都可用于 I/O 端口，由地址编号决定访问对象。
**优点**是指令类型多、功能齐全；
**缺点**是减少了存储器容量，执行时间较长，程序阅读和理解困难。
2. **独立编址**：I/O 端口地址和存储单元地址各自独立。
I/O 端口采用 8 位 / 16 位地址编址，端口地址范围分别为 0 - 255（00H - FFH）/0 - 65535（0000H - FFFFH），I/O 操作使用输入 / 输出指令 IN 和 OUT。
**优点**是 I/O 端口地址不占用存储器空间，有专门的 I/O 指令，指令短、执行速度快，且 I/O 指令与存储器访问指令区别明显，便于程序阅读和理解；
**缺点**是访问 I/O 端口的指令功能较弱，部分操作需先将数据输入到 CPU 寄存器才能进行。
### 7.2.2 I/O 指令
#### 输入指令
- **直接寻址的输入指令**：`IN AL/AX,PORT`
**功能**：把 8/16 位数据直接由输入端口 PORT（地址 0 - 255）输入到 AL/AX 寄存器中。
例如 `IN AL,0DFH`，是从端口 0DFH 读一个字节到 AL 中。
- **间接寻址的输入指令**：`IN AL/AX,DX`
**功能**：把 8/16 位数据由 DX 寄存器指定的端口地址输入到 AL/AX 寄存器中。
例如先 `MOV DX,300H` 再 `IN AX,DX`，是从端口300H读一个字到AX 中。
#### 输出指令
- **直接寻址的输出指令**：`OUT PORT,AL/AX`
**功能**：把 AL/AX 的数据直接输出到 PORT 指定的输出端口地址（0 - 255）。
例如`OUT 80H,AL`，是把 AL 的内容输出到 80H 端口中 。
- **间接寻址的输出指令**：`OUT DX,AL/AX`
**功能**：把 AL/AX 的数据送到由 DX 寄存器指定的输出端口。
例如先`MOV DX,310H` ，再`OUT DX,AL`，是把 AL 的内容输出到端口 310H 中。

### 7.2.3 I/O 地址分配
I/O 地址空间分为两部分：
1. **供系统板上的 I/O 芯片使用**：如定时 / 计数器、中断控制器、DMA 控制器、并行接口等。
2. **供 I/O 扩展槽上的接口控制卡使用**：像软驱卡、硬驱卡、图形卡、声卡、打印卡、串行通信卡等
为**避免端口地址冲突**，在使用和设计接口电路时应遵循以下原则：
1. 已被系统使用的端口地址，不能再作它用。
2. 系统声明保留的地址，尽量不要使用，否则可能与其他或未来产品发生 I/O 端口地址重叠和冲突，造成与系统不兼容。
3. 一般用户可使用 300H - 31FH 地址，为避免与其他用户开发的插板发生地址冲突，最好采用地址开关。
### 7.2.4 I/O 端口地址译码
#### **一般译码原则**：把地址分为两部分
高位地址线与 CPU 的控制信号组合，通过译码产生 I/O 接口芯片的片选信号，实现片间寻址，片选地址线连接较复杂，分为固定式和可选式译码；
低位地址线直接连到 I/O 接口芯片，实现片内寻址，即访问片内寄存器，片内地址线只需将芯片的地址输入线与系统地址总线的相应片内地址线一一相连。
#### **1.固定式端口地址译码**：
接口中用到的端口地址由**硬件连线决定**，**不能更改**，多用于不需改变端口地址的场合。
当只需要一个端口地址时，可采用门电路构成译码电路，
	例如 “读 2F8H 端口” 的电路，AEN 参加译码，AEN = 0 时译码有效，AEN = 1 时译码无效。
	当接口电路需要多个端口地址时，一般采用译码器进行译码，常用的译码器有 2 - 4 译码器 74LS139、3 - 8 译码器 74LS138、4 - 16 译码器 74LS154 等。
	以 PC/XT 机为例，使用低 10 位地址（A9 - A0）寻址 I/O 端口，I/O 地址空间占 1K，A9 = 0 时，寻址系统板上的 512 个端口；A9 = 1 时，寻址 I/O 通道上的 512 个端口。
#### **2.开关式可选地址译码**：
能适应**不同场合**的地址分配或为系统以后**扩展**留有余地，可通过开关使接口卡的 I/O 端口地址根据要求改变而无需改动线路，有**两种电路结构形式**：
**直接使用拨动开关或跳接开关**：
- 例如两个异步通信接口 COM1 和 COM2 的地址译码电路，通过跳接开关 U15 不同的连接方式，可选择 COM1（地址范围为 3F8H - 3FFH）或 COM2（地址范围为 2F8H - 2FFH）为当前串行口适配器。![[../../MCU_Picture/Pasted image 20250509235652.png]]
**使用地址开关加比较器**：
- 关键器件是比较器 74LS688，有两组输入端和一个输出端，当 P7 - P0 = Q7 - Q0 时，输出低电平；当 P7 - P0 ≠ Q7 - Q0 时，输出高电平。![[../../MCU_Picture/Pasted image 20250509235701.png]]
### [[../../MCU_Contents/第7章 输入输出技术|回到目录]]