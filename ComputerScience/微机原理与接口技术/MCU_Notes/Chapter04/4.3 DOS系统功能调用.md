### 4.3.1 系统功能调用方法
DOS 系统功能调用的步骤如下：
1. 设置所要调用功能的入口参数。
2. 在 AH 寄存器中存入所要调用功能的功能号。
3. 执行 INT 21H 指令，自动转入中断子程序入口。
4. 相应中断子程序运行完毕，按规定获得出口参数。
### 4.3.2 常用的 DOS 系统功能调用
1. **带回显的键盘单字符输入（1 号功能）**
    - **功能**：从键盘读入一个字符，将该字符的 ASCII 码值送 AL 寄存器，同时回显在屏幕上。
    - **入口参数**：无。
    - **出口参数**：AL 寄存器存放输入字符的 ASCII 码值。
    - **格式**：
```assembly
MOV AH，1
INT 21H
```
- **说明**：输入一个字符后，不需要输入回车键。
2. **不带回显的键盘单字符输入（8 号功能）**：文档中未详细阐述此功能的具体内容，可推测其功能与 1 号功能类似，区别在于输入字符时不会在屏幕上回显。
3. **单字符输出（2 号功能）**
    - **功能**：将以 DL 寄存器的内容为 ASCII 码值的 ASCII 字符输出到屏幕上。
    - **入口参数**：DL＝要显示的字符（或其 ASCII 码值）。
    - **出口参数**：无。
    - **格式**：
```assembly
MOV DL，要显示的字符
MOV AH，2
INT 21H
```
- **说明**：使用时需掌握回车符（0DH）和换行符（0AH）的使用。例如，要使光标回到下一行的行首，可使用以下指令：
```assembly
MOV DL, 0DH  ;显示回车符
MOV AH, 02H
INT 21H  
MOV DL, 0AH  ;显示换行符
MOV AH, 02H 
INT 21H
```
4. **单字符输入或显示 (06H 功能)**
    - **入口参数**：DL = 0FFH（输入）；DL≠0FFH (输出)，其中 DL 是要显示字符的 ASCII 码。
    - **出口参数**：若有输入（ZF＝0），AL＝输入的字符；否则（ZF＝1），AL＝0。
    - **功能**：实现输入单个字符或显示指定的字符。
    - **示例**：
```assembly
MOV DL，0FFH  ;输入
MOV AH，6
INT 21H
MOV DL，24H   ;将‘$’输出
MOV AH，6
INT 21H
```
- **与 01H 的区别**：01H 功能等待用户键入，06H 功能不等待用户键入。
5. **字符串显示（9 号功能）**
    - **功能**：将 DS:DX 所指的以 $ 字符结尾的一个字符串输出到屏幕上。
    - **入口参数**：DS:DX＝要显示的字符串在内存中的首地址。
    - **出口参数**：无。
    - **格式**：
```assembly
LEA DX，字符串变量名
MOV AH，9
INT 21H
```
- **说明**：要显示的字符串必须以 “作为结束标志，但’不被显示。例如：
```assembly
str DB‘HELLO world!’,‘$’
……
LEA DX，str 	
MOV AH，9
INT 21H
```
6. **字符串输入（0AH 号功能）**
    - **功能**：从键盘读入一个字符串，将其保存到 DS:DX 指定的内存缓冲区中。缓冲区由 3 部分组成：第一字节定义缓冲区大小；第二字节用于系统回填实际输入的字符个数；从第三字节开始保存键盘输入字符的 ASCII 码值。
    - **入口参数**：DS：DX＝存放该字符串的输入缓冲区的首地址。
    - **出口参数**：实际输入字符个数保存在缓冲区第二字节的位置（不包括回车符） ，实际输入字符的 ASCII 码值（包括回车 0DH）顺序保存在缓冲区第三字节开始的位置。
    - **说明**：可输入的字符个数最多为缓冲区第一字节内容减 1，最少字符个数为 0；输入以按 “回车键” 结束，并将回车字符（0DH）保存在输入字符的最后一个位置上。
    - **格式**：
```assembly
LEA DX，缓冲区首地址；设DS已指向用户定义的数据段
MOV AH，10  ;或0AH
INT 21H
```
- **调用方法示例**：
```assembly
BUF DB 20  ;定义缓冲区大小，实际可输入字符最多20 - 1个
DB ？     ;存放实际输入的字符个数，由系统自动设置
DB 20 DUP（？）  ;存放实际输入的字符串
……
LEA DX，BUF	
MOV AH，10
INT 21H
```
7. **程序正常返回系统（4CH 号功能）**
    - **功能**：返回系统。
    - **入口参数**：AL = 终止代码或无。
    - **格式**：
```assembly
MOV AH，4CH
INT 21H
;或
MOV AX，4C00H
INT 21H
```
### [[../../MCU_Contents/第4章 汇编语言程序设计|回到目录]]